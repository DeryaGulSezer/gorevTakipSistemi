<div class="user-tasks-container">
  <!-- Header -->
  <div class="header">
    <div class="header-content">
      <h1>GÃ¶revlerim</h1>
      <div class="user-info" *ngIf="currentUser">
        <span class="user-icon">ğŸ‘¤</span>
        <div class="user-details">
          <span class="user-name">{{ currentUser.fullName || currentUser.username }}</span>
          <span class="user-id">(ID: {{ currentUser.id }})</span>
        </div>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn btn-refresh" (click)="refresh()" [disabled]="loading">
        <span *ngIf="!loading">ğŸ”„ Yenile</span>
        <span *ngIf="loading">â³ YÃ¼kleniyor...</span>
      </button>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-container">
    <div class="stat-card total">
      <div class="stat-icon">ğŸ“Š</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.totalTasks }}</div>
        <div class="stat-label">Toplam GÃ¶rev</div>
      </div>
    </div>
    <div class="stat-card active">
      <div class="stat-icon">âš¡</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.activeTasks }}</div>
        <div class="stat-label">Aktif GÃ¶rev</div>
      </div>
    </div>
    <div class="stat-card completed">
      <div class="stat-icon">âœ…</div>
      <div class="stat-content">
        <div class="stat-number">{{ stats.completedTasks }}</div>
        <div class="stat-label">Tamamlanan</div>
      </div>
    </div>
  </div>

  <!-- Filter Tabs -->
  <div class="filter-tabs">
    <button 
      class="tab-button"
      [class.active]="filterStatus === 'active'"
      (click)="changeFilter('active')">
      âš¡ Aktif GÃ¶revler ({{ stats.activeTasks }})
    </button>
    <button 
      class="tab-button"
      [class.active]="filterStatus === 'all'"
      (click)="changeFilter('all')">
      ğŸ“‹ TÃ¼m GÃ¶revler ({{ stats.totalTasks }})
    </button>
    <button 
      class="tab-button"
      [class.active]="filterStatus === 'completed'"
      (click)="changeFilter('completed')">
      âœ… Tamamlanan ({{ stats.completedTasks }})
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-container">
    <div class="loading-spinner"></div>
    <p>GÃ¶revler yÃ¼kleniyor...</p>
  </div>

  <!-- Success Message -->
  <div *ngIf="success" class="alert alert-success">
    <div class="alert-content">
      <span class="alert-icon">âœ…</span>
      <div class="alert-text">{{ success }}</div>
      <button class="alert-close" (click)="success = null">Ã—</button>
    </div>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="alert alert-error">
    <div class="alert-content">
      <span class="alert-icon">âš ï¸</span>
      <div class="alert-text">{{ error }}</div>
      <button class="alert-close" (click)="error = null">Ã—</button>
    </div>
  </div>

  <!-- Tasks List -->
  <div *ngIf="!loading && !error" class="tasks-container">
    <div *ngIf="gorevler.length === 0" class="no-tasks">
      <div class="no-tasks-message">
        <span class="no-tasks-icon">
          {{ filterStatus === 'active' ? 'âš¡' : filterStatus === 'completed' ? 'âœ…' : 'ğŸ“‹' }}
        </span>
        <h3>
          {{ filterStatus === 'active' ? 'Aktif gÃ¶rev bulunmuyor' : 
             filterStatus === 'completed' ? 'TamamlanmÄ±ÅŸ gÃ¶rev bulunmuyor' : 
             'HenÃ¼z gÃ¶rev bulunmuyor' }}
        </h3>
        <p>
          {{ filterStatus === 'active' ? 'Åu anda Ã¼zerinde Ã§alÄ±ÅŸmanÄ±z gereken bir gÃ¶rev yok.' :
             filterStatus === 'completed' ? 'HenÃ¼z tamamladÄ±ÄŸÄ±nÄ±z bir gÃ¶rev bulunmuyor.' :
             'Size atanmÄ±ÅŸ hiÃ§bir gÃ¶rev bulunamadÄ±.' }}
        </p>
      </div>
    </div>

    <!-- Tasks Grid -->
    <div *ngIf="gorevler.length > 0" class="tasks-grid">
      <div *ngFor="let gorev of gorevler; trackBy: trackByGorevId" 
           class="task-card"
           [class.completing]="isCompleting(gorev.gorevid)">
        
        <!-- Task Header -->
        <div class="task-header">
          <div class="task-title">{{ gorev.isim }}</div>
          <div class="task-badges">
            <span class="priority-badge" [ngClass]="getPriorityClass(gorev.priority)">
              {{ gorev.priority }}
            </span>
            <span class="status-badge" [ngClass]="getStatusClass(gorev.status)">
              {{ getStatusText(gorev.status) }}
            </span>
          </div>
        </div>

        <!-- Task Description -->
        <div class="task-description">
          {{ gorev.description }}
        </div>

        <!-- Task Meta -->
        <div class="task-meta">
          <div class="task-id">
            <span class="meta-label">GÃ¶rev ID:</span>
            <span class="meta-value">#{{ gorev.gorevid }}</span>
          </div>
        </div>

        <!-- Task Actions -->
        <div class="task-actions">
          <!-- Aktif gÃ¶revler iÃ§in durumu deÄŸiÅŸtirme butonlarÄ± -->
          <div *ngIf="gorev.status !== 'COMPLETED'" class="status-actions">
            <button 
              *ngIf="gorev.status === 'PENDING'"
              class="btn btn-start"
              (click)="updateTaskStatus(gorev, 'IN_PROGRESS')"
              title="GÃ¶reve baÅŸla">
              â–¶ï¸ BaÅŸla
            </button>
            
            <button 
              *ngIf="gorev.status === 'IN_PROGRESS'"
              class="btn btn-pause"
              (click)="updateTaskStatus(gorev, 'PENDING')"
              title="GÃ¶revi duraklat">
              â¸ï¸ Duraklat
            </button>
          </div>

          <!-- Bitirdim butonu (sadece aktif gÃ¶revler iÃ§in) -->
          <button 
            *ngIf="gorev.status !== 'COMPLETED'"
            class="btn btn-complete"
            (click)="completeTask(gorev)"
            [disabled]="isCompleting(gorev.gorevid)"
            title="GÃ¶revi tamamla">
            <span *ngIf="!isCompleting(gorev.gorevid)">ğŸ‰ Bitirdim</span>
            <span *ngIf="isCompleting(gorev.gorevid)" class="completing-spinner">â³ TamamlanÄ±yor...</span>
          </button>

          <!-- TamamlanmÄ±ÅŸ gÃ¶revler iÃ§in bilgi -->
          <div *ngIf="gorev.status === 'COMPLETED'" class="completed-info">
            <span class="completed-icon">ğŸ‰</span>
            <span class="completed-text">TamamlandÄ±!</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>